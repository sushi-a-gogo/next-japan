<app-modal (close)="close.emit(true)">
  <div class="progress-spinner nx-flex row al-c jc-c" [class.open]="busy()">
    @if(busy()) {
    <app-loading-spinner message="Sending Requests..." />
    }
  </div>
  <header class="dialog">
    <div class="dialog-title">Event Registration</div>
    <button
      type="button"
      class="dialog-close"
      mat-icon-button
      (click)="close.emit(true)"
    >
      <span class="material-icons">close</span>
    </button>
  </header>
  <main class="dialog nx-flex col gap-10" #main>
    @if(completed()) {
    <div class="completed nx-flex row al-c gap-16">
      <div class="icon nx-flex al-c jc-c">
        <span class="material-icons">pending_actions</span>
      </div>
      <p>
        We have received your registration request. You will be notified once
        your registration is complete!
      </p>
    </div>
    } @else { @for(location of selectedLocations; track location.locationId) {
    <app-registration-location
      [location]="location"
      [locationCount]="selectedLocations.length"
    />
    } }
    <div class="note">
      Registration is first-come, first-served and spots are limited. You'll be
      notified when your spot is confirmed. You can cancel your request up to 48
      hours before the event starts. Questions? Contact us - we're happy to
      help!
    </div>
  </main>
  <footer class="dialog">
    @if(selected().length) {
    <button
      type="button"
      matRipple
      class="app-button dialog-button app-button-outlined"
      (click)="closeDialog()"
    >
      Cancel
    </button>
    <button
      (click)="sendRequest()"
      type="button"
      matRipple
      class="app-button dialog-button app-button-filled"
    >
      Send Request
    </button>
    } @else {
    <a
      type="button"
      matRipple
      class="app-button dialog-button app-button-outlined"
      routerLink="/event/registrations"
    >
      Manage Your Events
    </a>
    <button
      (click)="closeDialog()"
      type="button"
      matRipple
      class="app-button dialog-button app-button-filled"
    >
      Done
    </button>
    }
  </footer>
</app-modal>
