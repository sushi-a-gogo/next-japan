<app-modal (close)="cancel()">
  <div class="container">
    @if(busy()) {
    <div class="spinner">
      <mat-spinner
        diameter="40"
        strokeWidth="5"
        class="blue-spin"
      ></mat-spinner>
    </div>
    }
    <div class="nx-flex col gap-24 fade-in" [class.open]="loaded() && !busy()">
      <header class="nx-flex row al-c jc-sb">
        <span class="subhead"> {{ modeHeaderText() }} </span>
        <button
          aria-label="Close dialog"
          type="button"
          class="dialog-close"
          mat-icon-button
          (click)="cancel()"
        >
          <span class="material-icons">close</span>
        </button>
      </header>
      <main>
        @if(signUpMode()) {
        <app-sign-up-form />
        } @else {
        <ul class="flex-column">
          @for(user of users(); track user.userId) {
          <li>
            <button
              class="app-button flex-button user"
              [class.app-button-filled]="selectedUserId() === user.userId"
              [class.app-button-outlined]="selectedUserId() !== user.userId"
              (click)="select(user.userId)"
            >
              <app-avatar [size]="36" [avatar]="user" />
              <span>{{ user.firstName }} {{ user.lastName }}</span>
            </button>
          </li>
          }
        </ul>
        }
      </main>
      <footer>
        <button
          class="app-button dialog-button app-button-filled"
          (click)="signin()"
          [disabled]="!selectedUserId()"
        >
          Next
        </button>
      </footer>
      <div class="switchbox nx-flex row al-c gap-5">
        {{ modeSupportingText() }}
        <button class="text-button" (click)="switchMode()">
          {{ modeButtonText() }}
        </button>
      </div>
    </div>
  </div>
</app-modal>
